FROM osrf/ros:humble-desktop

RUN apt-get update && apt-get install -y \
    ros-humble-cartographer \
    ros-humble-cartographer-ros \
    ros-humble-robot-state-publisher \
    ros-humble-joint-state-publisher \
    ros-humble-xacro \
    ros-humble-tf2-ros \
    ros-humble-tf2-tools \
    ros-humble-cyclonedds \
    ros-humble-rmw-cyclonedds-cpp \
    python3-colcon-common-extensions \
  && rm -rf /var/lib/apt/lists/*

WORKDIR /ros2_ws/src
RUN git clone --depth 1 https://github.com/mathrosas/fastbot.git

WORKDIR /ros2_ws
RUN . /opt/ros/humble/setup.bash \
 && colcon build --symlink-install \
      --packages-select \
        Lslidar_ROS2_driver \
        fastbot_description \
        fastbot_bringup

CMD ["/bin/bash","-lc","\
  source /opt/ros/humble/setup.bash && \
  source /ros2_ws/install/setup.bash && \
  exec ros2 launch fastbot_bringup bringup_slam_real.launch.py\
"]
